The first stage of snappiness consists of two factors. Factor one is the estimated travel time in relation to appointment length, where long travel is discouraged. snappiness_travel is measured on a scale of 0-1 and defined as:

travel_total = travel_before + travel_after
travel_ratio = travel_total / appointment_length / 2
snappiness_travel = 1 - MIN(travel_ratio, 1)

The second factor is downtime, which measures unused time before and after the proposed appointment. The downtime before the appointment is measured from the previous appointment to the beginning of the estimated start of travel to the proposed appointment. The downtime after the appointment is measured from the estimated end of travel back from the proposed appointment to the start of the following appointment.

The factor of downtime is calculated as a ratio of downtime before and downtime after the appointment, where a ratio approaching 0 is encouraged for "snapping" of the proposed appointment to existing appointments, and avoiding unusable downtime. snappiness_downtime is measured on a scale of 0-1 and defined as:

downtime_before = proposed_appointment.travel_before_start - previous_appointment.end_time
downtime_after = following_appointment.start_time - proposed_appointment.travel_after_end
downtime_ratio = min(downtime_before, downtime_after) / max(downtime_before, downtime_after)
snappiness_downtime = 1 - downtime_ratio

The resulting snappiness of the appointment is an average of the factors, weighted according to the preferences of the person. It is measured on ascale from 0-1 and defined as:

snappiness = (snappiness_travel * snappiness_travel_weight  + snappiness_downtime * snappiness_downtime_weight) / (snappiness_travel_weight + snappiness_downtime_weight)

Example: The previous appointment ends at 10:00. The proposed appointment is from 13:00-14:00. The following appointment is at 17:00. Travel is estimated to be 30 minutes to and from the proposed appoinment. Therefore start of travel is at 12:30 and end of travel is at 14:30. Downtime before is 2.5 hours and downtime after is 2.5. Factor weights were all set to 1.

snappiness_travel = 50%
snappiness_travel_weight = 1
snappiness_downtime = 0%
snappiness_downtime_weight = 1
snappiness = 25%